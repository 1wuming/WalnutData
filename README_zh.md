<img src="https://github.com/1wuming/WalnutData/blob/main/README_IMAGES/Category%20Examples%20of%20WalnutData.jpg" alt="Category Examples WalnutData">

# 1. WalnutData 下载地址
我们提供了两种方式来获取WalnutData：
  - **IEEEDataPort**：https://ieee-dataport.org/documents/walnutdata-construction-green-walnut-dataset-based-uav-and-model-evaluation

  - **百度网盘**：
  
# 2. 数据集构建
我们分别在2024年7月18日至9月14日之间对8块核桃样本地进行数据采集，这些样本地均处于中国云南省大理白族自治州漾濞县。另外，为了获取光照情况的变化，我们在9点至19点之间进行拍摄。数据采集设备统一使用DJI Matrice 300 RTK无人机和Zenmuse P1（35mm F2.8）镜头，无人机全程按照预先规划的航线进行从上往下的角度（-90°）拍摄，飞行路径完全涵盖每块样本地的范围。为了减少飞行高度过高与相机运动过快对成像质量的影响，我们在保证飞行安全的情况下，将飞行速度设置在1-3m/s之间，飞行高度设置在12-30m之间。

由于无人机航拍图像分辨率（8192×5460像素）过大，不利于模型的训练，因此本研究将筛选后的原始图像均按照步长为512进行图像切割，切割后的图像分辨率均为1024×1024像素。经过上述步骤的处理，最终形成了本研究的数据集，共30240张图像。

以下表格是WalnutData的详细信息。


|    名称   |  图片数量（张） |   目标数量（个）  | 平均每张图像目标数量（个） | 
|----------|-----------|------------|---------------------|
|   训练集  |     21167 |   495812   |     23.424    | 
|   验证集  |     6048  |   139255   |     23.025    |   
|   测试集  |     3025  |   71141    |     23.518    |   


|    名称   |  大尺寸目标数量（个） |   中尺寸目标数量（个）  | 小尺寸目标数量（个） | 
|-----------|-----------|----------|--------------|
|   训练集  |     526   |  211669  |    283617    | 
|   验证集  |     175   |  59371   |    79709     |   
|   测试集  |     74    |  30047   |    41020     |   

下图展示了WalnutData中几张数据集示例：

<img src="https://github.com/1wuming/WalnutData/blob/main/README_IMAGES/Annotation%20Examples%20of%20WalnutData.jpg" alt="Annotation Examples WalnutData">

# 3. 数据集分析

## 3.1 灰度值分析
训练集、验证集和测试集的平均灰度值分别为107.316、108.048、107.544，低于中间灰度值127.5的占比分别为76.31%、75.59%、75.81%，由此说明WalnutData中大部分青皮核桃是处于逆光或被树叶遮挡在光线较暗的地方。

下图为WalnutData的平均灰度值分布。
![image](https://github.com/1wuming/WalnutData/blob/main/README_IMAGES/Grayscale%20Value%20Statistics.jpg)

## 3.2 WalnutData类别实例分布
训练集、验证集和测试集划分的比例为7:2:1，分别为21167张、6048张和3025张。另外，在类别数量分布安排中，我们尽可能保证其分布的相似性和均衡性，数据集划分后的类别实例分布信息如下图所示。
![image](https://github.com/1wuming/WalnutData/blob/main/README_IMAGES/Instance%20Distribution%20Information%20After%20the%20Dataset%20Is%20Partitioned.jpg)

下面两张图为数据集中注释框的分布情况：

<img src="https://github.com/1wuming/WalnutData/blob/main/README_IMAGES/labels_correlogram.jpg" alt="labels_correlogram" width="500"/>
<img src="https://github.com/1wuming/WalnutData/blob/main/README_IMAGES/labels.jpg" alt="labels" width="500"/>

# 4. 实验结果

## 4.1 WalnutData在一阶段目标检测算法的实验结果
 下表为一系列主流算法在WalnutData验证集上的评估。其中，mAP50:95、mAP50、mAP(A1)、mAP(B1)、mAP(B2)、mAP(A2)指标的单位均为%。

|     Model         |     #Param.    |     GFLOPs     |     mAP50    |     mAP50:95    |     mAP(A1)    |     mAP(B1)    |     mAP(B2)    |     mAP(A2)    | 
|-------------------|----------------|---------------|----------------|-------------|---------------|----------------|------------------|---------------|
|     YOLOv11-x      |     56.83M      |     194.4G     |      94.0       |     71.7    |     88.7      |     86         |     83.7         |     86.9      | 
|     YOLOv11-l      |     25.28M      |     86.6G    |        91.7       |     68.0    |     88.9      |     84.8       |     84.6         |     80.1      |   
|     YOLOv11-m      |     20.03M      |     67.7G    |        91.3       |     66.7    |     88.5      |     85.8       |     84.4         |     80.2      |    
|     YOLOv11-s      |     9.41M      |     21.3G    |         84.7       |     58.7    |     88.7      |     86.2       |     85.3         |     80.5      |   
|     YOLOv11-n      |     2.58M      |     6.3G      |        74.6       |     48.5    |     88.5      |     85.8       |     84.4         |     80.2      |    
|     YOLOv10-x      |     31.59M      |     169.8G     |      94.4       |     72.6    |     84.2      |     82.6       |     83.8         |     80.7      |    
|     YOLOv10-l      |     25.72M      |     126.3G    |       92.0       |     67.6    |     87.2      |     85.4       |     84.2         |     79.8      |    
|     YOLOv10-b     |     20.41M      |     98.0G    |         90.9       |     65.9    |     82        |     85.1       |     82.6         |     80        |   
|     YOLOv10-m     |     16.45M     |     63.4G    |          89.1     |       63.4  |     83.9      |     82.6       |     83.6         |     79.7      |   
|     YOLOv10-s     |     8.03M      |     24.5G     |         86.3       |     59.9    |     88.1      |     86         |     86.6         |     81.5      |     
|     YOLOv10-n     |     2.69M      |     8.2G    |           75.9       |     49.6    |     87.9      |     85.4       |     85.2         |     81.6      |    
|     YOLOv9-e      |     -           |     -      |           93.8     |       70.6  |     87.3      |     85.3       |     84.6         |     82.3      |   
|     YOLOv9-c      |     -          |     -     |             92.1   |         67.8    |     75.7      |     74.8       |     66           |     73        |   
|     YOLOv9-m    |     -            |     -     |             89.7  |          64.1    |     83.8      |     79.3       |     78           |     80        | 
|     YOLOv9-s      |     -          |     -     |             80.9       |     55.3    |     82.6      |     82         |     83           |     77        |  
|     YOLOv9-t    |     -            |     -     |             72.2     |       47.3  |     82.3      |     81.8       |     83           |     78        |    
|     YOLOv8-x      |     68.12M      |     257.4G    |        94.6       |     72.7    |     88.7      |     86.2       |     85.3         |     80.5      |    
|     YOLOv8-l      |     43.60M      |     164.8G      |      93.6       |     70.6    |     88.5      |     85.8       |     84.4         |     80.2      |   
|     YOLOv8-m      |     25.84M      |     78.7G     |        92.2       |     68.0    |     84.2      |     82.6       |     83.8         |     80.7      |   
|     YOLOv8-s      |     11.12M      |     28.4G    |         86.2       |     59.7    |     87.2      |     85.4       |     84.2         |     79.8      |  
|     YOLOv8-n     |     3.00M        |     8.1G    |          75.2    |        49.2    |     82        |     85.1       |     82.6         |     80        |   
|     YOLOv7       |     -            |     -    |             67.0   |         40.1   |     83.9      |     82.6       |     83.6         |     79.7      |   
|     YOLOv6-l      |     -            |     -     |           87.1      |      60.1   |     88.1      |     86         |     86.6         |     81.5      |  
|     YOLOv6-m      |     -           |     -    |             83.7   |         56.9   |     87.9      |     85.4       |     85.2         |     81.6      |    
|     YOLOv6-s      |     -            |     -    |            87.8  |          59.6    |     87.3      |     85.3       |     84.6         |     82.3      |    
|     YOLOv6-n      |     -          |     -     |             74.2   |         47.8    |     75.7      |     74.8       |     66           |     73        |    
|     YOLOv5-x    |     86.19M        |     203.8G     |       94.5       |     70.8    |     83.8      |     79.3       |     78           |     80        |   
|     YOLOv5-l     |     46.12M         |     107.7G     |     93.3         |   68.4    |     82.6      |     82         |     83           |     77        |   
|     YOLOv5-m    |     20.86M          |     47.9G     |      90.9        |    64.7    |     82.3      |     81.8       |     83           |     78        | 
|     YOLOv5-s     |     7.02M         |     15.8G    |        84.5      |      57.0   |     88.7      |     86.2       |     85.3         |     80.5      |   
|     YOLOv5-n      |     1.76M        |     4.1G      |       72.0       |     45.1    |     88.5      |     85.8       |     84.4         |     80.2      |   
|     YOLOv4      |     -               |     -     |          57.3      |      31.3   |     84.2      |     82.6       |     83.8         |     80.7      |   
|     YOLOv3      |     61.51M         |     154.6G    |       94.7       |     71.6    |     87.2      |     85.4       |     84.2         |     79.8      |   
|     YOLOv3-SPP     |     62.56M      |     155.4G    |       95.1       |     71.4    |     82        |     85.1       |     82.6         |     80        |   
|     YOLOv3-Tiny     |     8.67M     |     12.9G    |         66.2       |     38.0    |     83.9      |     82.6       |     83.6         |     79.7      |  



## 4.2 在双阶段目标检测算法的实验结果

|     Model                    |     Image Size    |     Weight Size    |     AP50:95    |     AP50    |
|------------------------------|-------------------|--------------------|----------------|-------------|
|     Faster R-CNN R50-DC5     |     640           |     1300Mb         |     38.6       |     78.9    |
|     Faster R-CNN R50-FPN     |     640           |     333.3Mb        |     42.1       |     82.7    |
|     Faster R-CNN R50-C4      |     416           |     257.5Mb        |     24.8       |     59.8    |
|     Faster R-CNN R101-C4     |     416           |     422Mb          |     26.9       |     60      |
|     Faster R-CNN R101-DC5    |     416           |     1400Mb         |     25.3       |     57.8    |
|     Faster R-CNN R101-FPN    |     416           |     365.2Mb        |     35.9       |     76.1    |
|     RPN R50                  |     416           |     103.5Mb        |     25.4       |     55.8    |
|     Fast R-CNN  R50-FPN      |     416           |     318.7Mb        |     28.5       |     59.8    |

## 4.3 M<sup>4</sup>SFWD 在轻量级目标检测算法的实验结果

|     Model          |     #Param.    |     Flops    |     Weight Size    |     AP50:95    |     AP50    |     APFire    |     APSmoke    |     Precision    |     Recall    |     F1-socre    |
|--------------------|----------------|--------------|--------------------|----------------|-------------|---------------|----------------|------------------|---------------|-----------------|
|     YOLOv8n        |     3.2M       |     8.7G     |     6.3Mb          |     49.5       |     86.4    |     87.1      |     85.7       |     83.2         |     81.2      |     82.2        |
|     YOLOv8s        |     11.2M      |     28.6G    |     22.5Mb         |     50.3       |     86.4    |     87.9      |     85         |     83.1         |     81.4      |     82.2        |
|     YOLOv6-N       |     4.7M       |     11.4G    |     10.0Mb         |     42         |     82.2    |     82.9      |     81.5       |     83.3         |     78.8      |     81.0        |
|     YOLOv6-S       |     18.5M      |     45.3G    |     10.2Mb         |     44.4       |     84.1    |     85        |     83.2       |     83.9         |     80.3      |     82.1        |
|     YOLOv6-N6      |     10.4M      |     49.8G    |     21.83Mb        |     42.1       |     82.1    |     82.8      |     81.3       |     83.7         |     78.9      |     81.2        |
|     YOLOv6-S6      |     41.4M      |     198G     |     85.84Mb        |     43.2       |     83.1    |     83.8      |     82.5       |     83.6         |     79.4      |     81.4        |
|     YOLOv5n        |     1.9M       |     4.5G     |     3.8Mb          |     40.1       |     84.9    |     86.1      |     83.7       |     84.3         |     79.1      |     81.6        |
|     YOLOv5s        |     7.2M       |     16.5G    |     14.4Mb         |     43.7       |     86.4    |     87.9      |     84.9       |     83.7         |     80.9      |     82.3        |
|     YOLOv4-tiny    |     -          |     6.8G     |     23.5Mb         |     -          |     64.5    |     51.9      |     77.1       |     80           |     58        |     67.2        |
|     YOLOv3-tiny    |     -          |     5.4G     |     34.7Mb         |     -          |     71.7    |     69.6      |     73.9       |     76           |     72        |     73.9        |


